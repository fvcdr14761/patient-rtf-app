<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Patient List → RTF Generator</title>
</head>

<body>
<h2>Paste Patient List</h2>
<textarea id="inputText" rows="15" style="width:100%;"></textarea>
<br><br>
<button onclick="generateRTF()">Generate RTF</button>

<script>
function generateRTF() {

    // ---------------------------------------
    // 1. GET RAW INPUT
    // ---------------------------------------
    const raw = document.getElementById("inputText").value.trim();

    // ---------------------------------------
    // 2. SPLIT INTO LINES (EACH LINE = 1 PATIENT BLOCK)
    // ---------------------------------------
    const lines = raw.split(/\n+/);

    // ---------------------------------------
    // 3. BUILD DATE IN YYYYMMDD FORMAT
    // ---------------------------------------
    const d = new Date();
    const dateStr = d.toISOString().slice(0,10).replace(/-/g,""); 
    // Example: "20251213"

    // ---------------------------------------
    // 4. CREATE PATIENT PARAGRAPHS
    //    Each needs:
    //    {line text}\par
    //    + 5 blank lines → \par\par\par\par\par
    // ---------------------------------------
    let patientBlocks = "";
    for (let line of lines) {
        const cleaned = line.trim();
        if (cleaned.length === 0) continue;
        patientBlocks += cleaned + "\\par\n\\par\\par\\par\\par\\par\n";
    }

    // ---------------------------------------
    // 5. CONSTRUCT RTF FILE
    //    Insert margins, font size, date, and patient blocks
    // ---------------------------------------
    const rtf =
`{\\rtf1\\ansi
\\margl170\\margr170\\margt850\\margb850
\\fs18
${dateStr}\\\\par
${patientBlocks}
}`;

    // ---------------------------------------
    // 6. DOWNLOAD THE FILE AS output.rtf
    // ---------------------------------------
    const blob = new Blob([rtf], { type: "application/rtf" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = "output.rtf";
    a.click();

    URL.revokeObjectURL(url);
}
</script>
</body>
</html>
